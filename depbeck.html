<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EvaluaciÃ³n BDI-II - CBTa 130</title>
<style>
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; margin: 0; background-color: #f0f2f5; color: #1c1c1e; }
    header { background: linear-gradient(135deg, #1565C0 0%, #1976D2 100%); color: white; text-align: center; padding: 25px; font-weight: bold; font-size: 1.4rem; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
    
    .container { max-width: 800px; margin: 20px auto; padding: 20px; background: white; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
    
    h2 { color: #1565C0; text-align: center; margin-top: 0; border-bottom: 2px solid #e3f2fd; padding-bottom: 10px; }
    
    .input-group { margin-bottom: 15px; }
    label { font-weight: 600; display: block; margin-bottom: 8px; color: #333; }
    input[type="text"], input[type="number"], input[type="date"] { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 8px; font-size: 16px; box-sizing: border-box; }

    .instructions { background-color: #e3f2fd; padding: 15px; border-radius: 8px; margin: 20px 0; font-size: 0.95em; line-height: 1.5; border-left: 5px solid #1565C0; }

    .question-card { background: #fff; border: 1px solid #e0e0e0; border-radius: 10px; padding: 15px; margin-bottom: 20px; }
    .question-title { font-weight: bold; font-size: 1.1em; margin-bottom: 10px; color: #000; }
    
    .option-label { display: flex; align-items: flex-start; padding: 10px; cursor: pointer; border-radius: 6px; transition: background 0.2s; }
    .option-label:hover { background-color: #f5f5f5; }
    .option-label input { margin-right: 12px; margin-top: 4px; transform: scale(1.3); flex-shrink: 0; }
    .option-text { font-size: 0.95em; }

    .buttons { display: flex; flex-direction: column; gap: 15px; margin-top: 30px; }
    button { padding: 16px; border: none; border-radius: 12px; font-size: 1.1em; font-weight: 700; color: white; cursor: pointer; width: 100%; transition: opacity 0.2s; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
    button:active { transform: scale(0.98); }
    
    .whatsapp { background-color: #25D366; }
    .reset { background-color: #757575; }

    #result-area { display: none; text-align: center; margin-top: 20px; padding: 20px; background: #e3f2fd; border-radius: 10px; }
</style>
</head>
<body>

<header>CBTa No.130<br><span style="font-size:0.8em; font-weight:normal">Inventario de DepresiÃ³n (BDI-II)</span></header>

<div class="container">
    <div id="test-form">
        <h2>Datos del Alumno</h2>
        <div class="input-group"><label>Nombre Completo:</label><input type="text" id="nombre" placeholder="Nombre del alumno" required></div>
        <div class="input-group"><label>Edad:</label><input type="number" id="edad" placeholder="AÃ±os cumplidos" required></div>
        <div class="input-group"><label>Fecha:</label><input type="date" id="fecha" required></div>

        <div class="instructions">
            <strong>Instrucciones:</strong> Elija la afirmaciÃ³n que mejor describa cÃ³mo se ha sentido durante las <strong>Ãºltimas dos semanas, incluyendo hoy</strong>.
        </div>

        <div id="cuestionario"></div>

        <div class="buttons">
            <button type="button" class="whatsapp" onclick="finalizarTest()">âœ… Finalizar y Enviar</button>
        </div>
    </div>

    <!-- ÃREA FINAL (Sin diagnÃ³sticos) -->
    <div id="result-area">
        <h3 style="color:#1565C0;">Â¡EvaluaciÃ³n Completada!</h3>
        <p>El cuestionario ha sido registrado correctamente.</p>
        <p>Por favor, envÃ­a los datos al orientador para su registro.</p>
        <div class="buttons">
            <button type="button" class="whatsapp" onclick="enviarWhatsApp()">ðŸ“² Enviar Datos por WhatsApp</button>
            <button type="button" class="reset" onclick="location.reload()">ðŸ”„ Nuevo Test</button>
        </div>
    </div>
</div>

<script>
    const NUMERO_DESTINO = "523111477413"; 

    const items = [
        { t: "1. Tristeza", o: ["No me siento triste", "Me siento triste gran parte del tiempo", "Estoy triste todo el tiempo", "Estoy tan triste o infeliz que no puedo soportarlo"] },
        { t: "2. Pesimismo", o: ["No estoy desalentado respecto a mi futuro", "Me siento mÃ¡s desalentado respecto a mi futuro que antes", "No espero que las cosas funcionen para mÃ­", "Siento que mi futuro es desesperanzador y que sÃ³lo empeorarÃ¡"] },
        { t: "3. Fracaso", o: ["No me siento como un fracasado", "He fracasado mÃ¡s de lo que deberÃ­a", "Cuando miro hacia atrÃ¡s veo muchos fracasos", "Siento que como persona soy un fracaso total"] },
        { t: "4. PÃ©rdida de Placer", o: ["Obtengo tanto placer como siempre de las cosas que disfruto", "No disfruto de las cosas tanto como antes", "Obtengo muy poco placer de las cosas que solÃ­a disfrutar", "No obtengo ningÃºn placer de las cosas que solÃ­a disfrutar"] },
        { t: "5. Sentimientos de Culpa", o: ["No me siento particularmente culpable", "Me siento culpable respecto a muchas cosas que he hecho o deberÃ­a haber hecho", "Me siento bastante culpable la mayor parte del tiempo", "Me siento culpable todo el tiempo"] },
        { t: "6. Sentimientos de Castigo", o: ["No siento que estÃ© siendo castigado", "Siento que podrÃ­a ser castigado", "Espero ser castigado", "Siento que estoy siendo castigado"] },
        { t: "7. Disconformidad con uno mismo", o: ["Me siento igual respecto a mÃ­ mismo que siempre", "He perdido confianza en mÃ­ mismo", "Estoy decepcionado de mÃ­ mismo", "No me gusto a mÃ­ mismo"] },
        { t: "8. AutocrÃ­tica", o: ["No me critico o culpo mÃ¡s de lo habitual", "Soy mÃ¡s crÃ­tico conmigo mismo de lo que solÃ­a ser", "Me critico por todos mis errores", "Me culpo por todo lo malo que sucede"] },
        { t: "9. Pensamientos o Deseos Suicidas", o: ["No tengo ningÃºn pensamiento de suicidio", "Tengo pensamientos de suicidio, pero no los llevarÃ­a a cabo", "Me gustarÃ­a suicidarme", "Me suicidarÃ­a si tuviera la oportunidad"] },
        { t: "10. Llanto", o: ["No lloro mÃ¡s de lo habitual", "Lloro mÃ¡s de lo que solÃ­a hacerlo", "Lloro por cualquier pequeÃ±ez", "Siento ganas de llorar pero no puedo"] },
        { t: "11. AgitaciÃ³n", o: ["No estoy mÃ¡s inquieto o nervioso que lo habitual", "Me siento mÃ¡s inquieto o nervioso que lo habitual", "Estoy tan inquieto que me es difÃ­cil quedarme quieto", "Estoy tan inquieto que tengo que estar moviÃ©ndome o haciendo algo"] },
        { t: "12. PÃ©rdida de InterÃ©s", o: ["No he perdido interÃ©s en otras personas o actividades", "Estoy menos interesado en otras personas o cosas que antes", "He perdido casi todo el interÃ©s en otras personas o cosas", "Me es difÃ­cil interesarme en algo"] },
        { t: "13. IndecisiÃ³n", o: ["Tomo decisiones tan bien como siempre", "Me resulta mÃ¡s difÃ­cil tomar decisiones que lo habitual", "Tengo mucha mÃ¡s dificultad para tomar decisiones que lo habitual", "Tengo problemas para tomar cualquier decisiÃ³n"] },
        { t: "14. DesvalorizaciÃ³n", o: ["No siento que sea inÃºtil", "No me considero tan valioso y Ãºtil como solÃ­a ser", "Me siento mÃ¡s inÃºtil comparado con otras personas", "Me siento completamente inÃºtil"] },
        { t: "15. PÃ©rdida de EnergÃ­a", o: ["Tengo tanta energÃ­a como siempre", "Tengo menos energÃ­a de la que solÃ­a tener", "No tengo suficiente energÃ­a para hacer muchas cosas", "No tengo energÃ­a para hacer nada"] },
        { t: "16. Cambios en el PatrÃ³n de SueÃ±o", special: true, o: [{v:0, t:"No he experimentado ningÃºn cambio"},{v:1, t:"1a. Duermo algo mÃ¡s de lo habitual"},{v:1, t:"1b. Duermo algo menos de lo habitual"},{v:2, t:"2a. Duermo mucho mÃ¡s de lo habitual"},{v:2, t:"2b. Duermo mucho menos de lo habitual"},{v:3, t:"3a. Duermo la mayor parte del dÃ­a"},{v:3, t:"3b. Me despierto 1-2 horas mÃ¡s temprano"}]},
        { t: "17. Irritabilidad", o: ["No estoy mÃ¡s irritable que lo habitual", "Estoy mÃ¡s irritable que lo habitual", "Estoy mucho mÃ¡s irritable que lo habitual", "Estoy irritable todo el tiempo"] },
        { t: "18. Cambios en el Apetito", special: true, o: [{v:0, t:"No he experimentado ningÃºn cambio"},{v:1, t:"1a. Apetito algo menor"},{v:1, t:"1b. Apetito algo mayor"},{v:2, t:"2a. Apetito mucho menor"},{v:2, t:"2b. Apetito mucho mayor"},{v:3, t:"3a. Sin apetito"},{v:3, t:"3b. Ganas de comer todo el tiempo"}]},
        { t: "19. Dificultad de ConcentraciÃ³n", o: ["Puedo concentrarme tan bien como siempre", "No puedo concentrarme tan bien como antes", "Me es difÃ­cil concentrarme en algo por mucho tiempo", "No puedo concentrarme en nada"] },
        { t: "20. Cansancio o Fatiga", o: ["No estoy mÃ¡s cansado o fatigado que lo habitual", "Me canso o fatigo mÃ¡s fÃ¡cilmente que lo habitual", "Estoy demasiado cansado o fatigado para hacer muchas cosas", "Estoy demasiado cansado para hacer casi todo"] },
        { t: "21. PÃ©rdida de InterÃ©s en el Sexo", o: ["Sin cambios en interÃ©s sexual", "Estoy menos interesado que antes", "Estoy mucho menos interesado ahora", "He perdido completamente el interÃ©s"] }
    ];

    const divCuestionario = document.getElementById('cuestionario');
    items.forEach((item, index) => {
        const num = index + 1;
        let html = `<div class="question-card"><div class="question-title">${item.t}</div>`;
        if(item.special) {
            item.o.forEach(op => html += `<label class="option-label"><input type="radio" name="item${num}" value="${op.v}" required><span class="option-text">${op.t}</span></label>`);
        } else {
            item.o.forEach((txt, val) => html += `<label class="option-label"><input type="radio" name="item${num}" value="${val}" required><span class="option-text">${val} - ${txt}</span></label>`);
        }
        html += `</div>`;
        divCuestionario.innerHTML += html;
    });

    document.getElementById('fecha').valueAsDate = new Date();
    let datosFinales = null;

    function finalizarTest() {
        const nombre = document.getElementById('nombre').value.trim();
        const edad = parseInt(document.getElementById('edad').value);
        const fecha = document.getElementById('fecha').value;
        if (!nombre || !edad) { alert("Complete nombre y edad."); return; }

        let total = 0, contestadas = 0;
        let alertasCodigos = []; // Usaremos cÃ³digos para las alertas, no texto dramÃ¡tico

        for (let i = 1; i <= 21; i++) {
            const el = document.querySelector(`input[name="item${i}"]:checked`);
            if (el) {
                const val = parseInt(el.value);
                total += val; contestadas++;
                
                // DetecciÃ³n silenciosa de riesgos (Item 9 es suicidio)
                if (i === 9 && val >= 1) alertasCodigos.push("A9"); 
                if (i === 2 && val === 3) alertasCodigos.push("A2"); 
            }
        }

        if (contestadas < 21) { alert(`Faltan preguntas (${contestadas}/21)`); return; }

        datosFinales = { nombre, edad, fecha, total, alertasCodigos };

        document.getElementById('test-form').style.display = 'none';
        document.getElementById('result-area').style.display = 'block';
        window.scrollTo(0,0);
    }

    function enviarWhatsApp() {
        if(!datosFinales) return;
        // Mensaje asÃ©ptico, solo datos.
        let m = `ðŸ“‹ *DATOS BDI-II*%0AðŸ‘¤ ${datosFinales.nombre} (${datosFinales.edad})%0AðŸ“… ${datosFinales.fecha}%0AðŸ“Š Puntos: ${datosFinales.total}`;
        
        // Si hay alertas, se envÃ­an como cÃ³digos (A9, A2) que tÃº sabes quÃ© significan, pero el alumno no se asusta.
        if (datosFinales.alertasCodigos.length > 0) m += `%0AðŸš© Flags: ${datosFinales.alertasCodigos.join(', ')}`;
        
        window.location.href = `https://wa.me/${NUMERO_DESTINO}?text=${m}`;
    }
</script>
</body>
</html>


