<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Evaluaci√≥n BDI-II - CBTa 130</title>
<style>
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; margin: 0; background-color: #f0f2f5; color: #1c1c1e; }
    header { background: linear-gradient(135deg, #1565C0 0%, #1976D2 100%); color: white; text-align: center; padding: 25px; font-weight: bold; font-size: 1.4rem; }
    .container { max-width: 800px; margin: 20px auto; padding: 20px; background: white; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
    h2 { color: #1565C0; text-align: center; border-bottom: 2px solid #e3f2fd; padding-bottom: 10px; }
    .input-group { margin-bottom: 15px; }
    label { font-weight: 600; display: block; margin-bottom: 8px; }
    input { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 8px; box-sizing: border-box; }
    
    .question-card { background: #fff; border: 1px solid #e0e0e0; border-radius: 10px; padding: 15px; margin-bottom: 20px; }
    .question-title { font-weight: bold; font-size: 1.1em; margin-bottom: 15px; color: #1565C0; }
    
    /* --- CORRECCI√ìN DE ALINEACI√ìN --- */
    .option-label { 
        display: flex; 
        align-items: flex-start; /* Alinea arriba */
        padding: 12px; 
        cursor: pointer; 
        border-radius: 6px; 
        border: 1px solid transparent;
        margin-bottom: 5px;
    }
    .option-label:hover { background-color: #e3f2fd; }
    
    .option-label input { 
        margin-right: 15px; 
        margin-top: 4px; /* Peque√±o ajuste para alinear con primera l√≠nea */
        width: 20px; 
        height: 20px; 
        flex-shrink: 0; /* Evita que se aplaste */
    }
    
    .option-text { font-size: 0.95rem; line-height: 1.4; color: #333; }

    .buttons { display: flex; flex-direction: column; gap: 15px; margin-top: 30px; }
    button { padding: 16px; border: none; border-radius: 12px; font-size: 1.1em; font-weight: 700; color: white; cursor: pointer; width: 100%; }
    .whatsapp { background-color: #25D366; }
    .local-save { background-color: #1565C0; }
    .reset { background-color: #757575; }
    .btn-back { background-color: #78909c; }
    #result-area { display: none; text-align: center; margin-top: 20px; padding: 20px; background: #e3f2fd; border-radius: 10px; }
</style>
</head>
<body>
<header>CBTa No.130<br><span style="font-size:0.8em;">Inventario de Depresi√≥n (BDI-II)</span></header>
<div class="container">
    <div id="test-form">
        <h2>Datos del Alumno</h2>
        <div class="input-group"><label>Nombre:</label><input type="text" id="nombre" required></div>
        <div class="input-group"><label>Edad:</label><input type="number" id="edad" required></div>
        <div class="input-group"><label>Fecha:</label><input type="date" id="fecha" required></div>
        <div id="cuestionario"></div>
        <div class="buttons">
            <button type="button" class="whatsapp" onclick="finalizarTest()">‚úÖ Finalizar</button>
            <button type="button" class="btn-back" onclick="window.location.href='index.html'">‚Ü©Ô∏è Cancelar</button>
        </div>
    </div>
    <div id="result-area">
        <h3 style="color:#1565C0;">Resultados Listos</h3>
        <div class="buttons">
            <button type="button" class="local-save" onclick="guardarLocalmente()">üíæ Guardar en Expediente</button>
            <button type="button" class="whatsapp" onclick="enviarWhatsApp()">üì≤ Enviar WhatsApp</button>
            <button type="button" class="reset" onclick="location.reload()">üîÑ Nuevo</button>
            <button type="button" class="btn-back" onclick="window.location.href='index.html'">üè† Men√∫</button>
        </div>
    </div>
</div>
<script>
    const NUMERO_DESTINO = "523111477413"; const STORAGE_KEY = "cbta_paciente_temp";
    const items = [
        { t: "1. Tristeza", o: ["No me siento triste.", "Me siento triste gran parte del tiempo.", "Me siento triste todo el tiempo.", "Me siento tan triste o desgraciado que no puedo soportarlo."] },
        { t: "2. Pesimismo", o: ["No estoy desalentado respecto a mi futuro.", "Me siento m√°s desalentado respecto de mi futuro que lo habitual.", "No espero que las cosas funcionen para mi.", "Siento que no hay esperanza para mi futuro y que s√≥lo puede empeorar."] },
        { t: "3. Fracaso", o: ["No me siento como un fracasado.", "He fracasado m√°s de lo que hubiera debido.", "Cuando miro hacia atr√°s, veo muchos fracasos.", "Siento que como persona soy un fracaso total."] },
        { t: "4. P√©rdida de Placer", o: ["Obtengo tanto placer como siempre por las cosas.", "No disfruto tanto de las cosas como sol√≠a hacerlo.", "Obtengo muy poco placer de las cosas que sol√≠a disfrutar.", "No puedo obtener ning√∫n placer de las cosas."] },
        { t: "5. Sentimientos de Culpa", o: ["No me siento particularmente culpable.", "Me siento culpable respecto de varias cosas que he hecho.", "Me siento bastante culpable la mayor parte del tiempo.", "Me siento culpable todo el tiempo."] },
        { t: "6. Sentimientos de Castigo", o: ["No siento que este siendo castigado.", "Siento que tal vez pueda ser castigado.", "Espero ser castigado.", "Siento que estoy siendo castigado."] },
        { t: "7. Disconformidad con uno mismo", o: ["Siento lo mismo que siempre respecto a mi mismo.", "He perdido confianza en m√≠ mismo.", "Estoy decepcionado conmigo mismo.", "No me gusto a m√≠ mismo."] },
        { t: "8. Autocr√≠tica", o: ["No me critico ni me culpo m√°s de lo habitual.", "Soy m√°s cr√≠tico conmigo mismo de lo que sol√≠a ser.", "Me critico a m√≠ mismo por todos mis errores.", "Me culpo a m√≠ mismo por todo lo malo que sucede."] },
        { t: "9. Pensamientos Suicidas", o: ["No tengo ning√∫n pensamiento de matarme.", "He tenido pensamientos de matarme, pero no lo har√≠a.", "Me gustar√≠a matarme.", "Me matar√≠a si tuviera la oportunidad."] },
        { t: "10. Llanto", o: ["No lloro m√°s de lo que sol√≠a hacerlo.", "Lloro m√°s de lo que sol√≠a hacerlo.", "Lloro por cualquier peque√±ez.", "Siento ganas de llorar pero no puedo."] },
        { t: "11. Agitaci√≥n", o: ["No estoy m√°s inquieto o tenso que lo habitual.", "Me siento m√°s inquieto o tenso que lo habitual.", "Estoy tan inquieto o agitado que me es dif√≠cil quedarme quieto.", "Estoy tan inquieto o agitado que tengo que estar movi√©ndome."] },
        { t: "12. P√©rdida de Inter√©s", o: ["No he perdido el inter√©s en otras actividades o personas.", "Estoy menos interesado que antes en otras personas o cosas.", "He perdido casi todo el inter√©s en otras personas o cosas.", "Me es dif√≠cil interesarme por cualquier cosa."] },
        { t: "13. Indecisi√≥n", o: ["Tomo mis decisiones tan bien como siempre.", "Me resulta m√°s dif√≠cil que de costumbre tomar decisiones.", "Encuentro mucha m√°s dificultad que antes para tomar decisiones.", "Tengo problemas para tomar cualquier decisi√≥n."] },
        { t: "14. Desvalorizaci√≥n", o: ["No siento que yo no sea valioso.", "No me considero tan valioso y √∫til como sol√≠a ser.", "Me siento menos valioso cuando me comparo con otros.", "Siento que no valgo nada."] },
        { t: "15. P√©rdida de Energ√≠a", o: ["Tengo tanta energ√≠a como siempre.", "Tengo menos energ√≠a que la que sol√≠a tener.", "No tengo suficiente energ√≠a para hacer demasiado.", "No tengo energ√≠a suficiente para hacer nada."] },
        { t: "16. Cambios en el Sue√±o", o: ["No he experimentado ning√∫n cambio en mis h√°bitos de sue√±o.", "Duermo un poco m√°s/menos de lo habitual.", "Duermo mucho m√°s/menos de lo habitual.", "Duermo la mayor parte del d√≠a / Me despierto muy temprano y no puedo volver a dormir."] },
        { t: "17. Irritabilidad", o: ["No estoy m√°s irritable que lo habitual.", "Estoy m√°s irritable que lo habitual.", "Estoy mucho m√°s irritable que lo habitual.", "Estoy irritable todo el tiempo."] },
        { t: "18. Cambios en el Apetito", o: ["No he experimentado ning√∫n cambio en mi apetito.", "Mi apetito es un poco menor/mayor que lo habitual.", "Mi apetito es mucho menor/mayor que lo habitual.", "No tengo apetito en absoluto / Quiero comer todo el tiempo."] },
        { t: "19. Dificultad de Concentraci√≥n", o: ["Puedo concentrarme tan bien como siempre.", "No puedo concentrarme tan bien como habitualmente.", "Me es dif√≠cil mantener la mente en algo por mucho tiempo.", "Encuentro que no puedo concentrarme en nada."] },
        { t: "20. Cansancio o Fatiga", o: ["No estoy m√°s cansado o fatigado que lo habitual.", "Me fatigo o canso m√°s f√°cilmente que lo habitual.", "Estoy demasiado fatigado o cansado para hacer muchas cosas.", "Estoy demasiado fatigado o cansado para hacer la mayor√≠a de las cosas."] },
        { t: "21. P√©rdida de Inter√©s en el Sexo", o: ["No he notado ning√∫n cambio reciente en mi inter√©s por el sexo.", "Estoy menos interesado en el sexo de lo que sol√≠a estar.", "Estoy mucho menos interesado en el sexo ahora.", "He perdido completamente el inter√©s en el sexo."] }
    ];

    const divCuestionario = document.getElementById('cuestionario');
    items.forEach((item, index) => {
        const num = index + 1;
        let html = `<div class="question-card"><div class="question-title">${num}. ${item.t}</div>`;
        item.o.forEach((txt, val) => {
            html += `<label class="option-label">
                        <input type="radio" name="item${num}" value="${val}">
                        <span class="option-text">${txt}</span>
                     </label>`;
        });
        divCuestionario.innerHTML += html + `</div>`;
    });
    document.getElementById('fecha').valueAsDate = new Date();
    let datosFinales = null;

    function finalizarTest() {
        const nombre = document.getElementById('nombre').value; const edad = document.getElementById('edad').value; const fecha = document.getElementById('fecha').value;
        if (!nombre || !edad) { alert("Datos incompletos"); return; }
        let total = 0, count = 0, alertas = [];
        for (let i = 1; i <= 21; i++) { const el = document.querySelector(`input[name="item${i}"]:checked`); if (el) { let val = parseInt(el.value); total += val; count++; if(i===9 && val>=1) alertas.push("A9"); } }
        if (count < 21) { alert("Faltan preguntas"); return; }
        datosFinales = { nombre, edad, fecha, total, alertas };
        document.getElementById('test-form').style.display = 'none'; document.getElementById('result-area').style.display = 'block'; window.scrollTo(0,0);
    }
    function guardarLocalmente() { if(!datosFinales) return; let cur = JSON.parse(localStorage.getItem(STORAGE_KEY)) || {}; let up = { ...cur, nombre: datosFinales.nombre, edad: datosFinales.edad, bdi: datosFinales.total }; localStorage.setItem(STORAGE_KEY, JSON.stringify(up)); alert("‚úÖ BDI guardado."); }
    function enviarWhatsApp() { if(!datosFinales) return; let m = `üìã *BDI-II*%0Aüë§ ${datosFinales.nombre}%0Aüìä Total: ${datosFinales.total}`; if(datosFinales.alertas.length>0) m+=`%0Aüö© ${datosFinales.alertas}`; window.open(`https://wa.me/${NUMERO_DESTINO}?text=${m}`, '_blank'); }
</script>
</body>
</html>


