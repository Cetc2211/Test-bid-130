<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Consentimiento Informado - CBTa 130</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
    body { font-family: "Times New Roman", serif; background-color: #f5f5f5; color: #000; padding: 20px; line-height: 1.6; }
    .paper { background: white; max-width: 850px; margin: 0 auto; padding: 40px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); border: 1px solid #ddd; }
    
    /* Encabezado Institucional en Pantalla */
    .header-screen { text-align: center; border-bottom: 2px solid #000; padding-bottom: 10px; margin-bottom: 20px; }
    .header-screen h1 { font-size: 16pt; margin: 0; text-transform: uppercase; font-weight: bold; }
    .header-screen h2 { font-size: 12pt; margin: 5px 0; font-weight: bold; }
    
    /* Estilos de Formulario */
    .section-title { background: #eee; padding: 5px 10px; font-weight: bold; border: 1px solid #000; margin-top: 20px; text-transform: uppercase; font-size: 11pt; }
    
    .row { display: flex; gap: 20px; margin-bottom: 10px; align-items: flex-end; }
    .col { flex: 1; }
    
    label { font-weight: bold; font-size: 10pt; display: block; }
    input[type="text"], input[type="number"], input[type="date"], select { 
        width: 100%; border: none; border-bottom: 1px solid #000; background: transparent; 
        font-family: "Courier New", monospace; font-size: 11pt; color: #000; padding: 2px;
    }
    input:focus { outline: none; border-bottom: 2px solid #2E7d32; }

    /* Checkboxes estilo documento */
    .check-group { margin: 10px 0; }
    .check-item { display: flex; align-items: flex-start; gap: 10px; margin-bottom: 5px; font-size: 11pt; }
    .check-item input { margin-top: 5px; }

    /* Botones flotantes */
    .fab-container { position: fixed; bottom: 30px; right: 30px; display: flex; flex-direction: column; gap: 10px; }
    .btn-fab { 
        background: #212121; color: white; border: none; padding: 15px 25px; 
        border-radius: 30px; font-weight: bold; cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.3); 
        transition: transform 0.2s; display: flex; align-items: center; gap: 10px;
    }
    .btn-fab:hover { transform: scale(1.05); background: #424242; }
    .btn-print { background: #d32f2f; }
    .btn-save { background: #1976D2; }

    p { text-align: justify; margin-bottom: 10px; font-size: 11pt; }
    ul { list-style: none; padding: 0; }
    
    @media print {
        .fab-container { display: none; }
        body { background: white; }
        .paper { box-shadow: none; border: none; padding: 0; }
    }
</style>
</head>
<body>

<div class="paper" id="document-content">
    
    <div class="header-screen">
        <h1>Centro de Bachillerato Tecnol√≥gico Agropecuario No. 130</h1>
        <h2>Guadalupe Victoria, Municipio de San Blas, Nayarit</h2>
        <div style="margin-top:10px; font-weight:bold;">CONSENTIMIENTO INFORMADO PARA EVALUACI√ìN E INTERVENCI√ìN PSICOPEDAG√ìGICA</div>
    </div>

    <div style="text-align:right; margin-bottom:15px;">
        <strong>Folio:</strong> <input type="text" id="folio" style="width:100px; display:inline-block;"> 
        <strong>Fecha:</strong> <input type="date" id="fecha" style="width:140px; display:inline-block;">
    </div>

    <!-- DATOS -->
    <div class="section-title">DATOS DE IDENTIFICACI√ìN</div>
    <div class="row" style="margin-top:10px;">
        <div class="col" style="flex:3"><label>Nombre del Estudiante:</label><input type="text" id="nombreEstudiante"></div>
        <div class="col"><label>Edad:</label><input type="number" id="edad"></div>
    </div>
    <div class="row">
        <div class="col"><label>Grupo:</label><input type="text" id="grupo"></div>
        <div class="col"><label>Semestre:</label><input type="text" id="semestre"></div>
        <div class="col" style="flex:2"><label>Especialidad:</label><input type="text" id="especialidad"></div>
    </div>
    <div class="row">
        <div class="col"><label>CURP:</label><input type="text" id="curp"></div>
    </div>
    <div class="row">
        <div class="col" style="flex:2"><label>Padre/Madre/Tutor:</label><input type="text" id="tutor"></div>
        <div class="col"><label>Parentesco:</label><input type="text" id="parentesco"></div>
    </div>
    <div class="row">
        <div class="col"><label>Tel√©fono:</label><input type="text" id="telefono"></div>
    </div>
    <div class="row">
        <div class="col" style="flex:2"><label>Profesional Responsable:</label><input type="text" id="profesional" value="Lic. Orientaci√≥n Educativa"></div>
        <div class="col"><label>C√©dula:</label><input type="text" id="cedula"></div>
    </div>

    <!-- I. INFORMACI√ìN -->
    <div class="section-title">I. INFORMACI√ìN SOBRE EL SERVICIO</div>
    <p>Por medio del presente, se informa que el estudiante recibir√° servicios de <strong>EVALUACI√ìN E INTERVENCI√ìN</strong> en el Depto. de Orientaci√≥n.</p>
    
    <strong>A. MOTIVO DE ATENCI√ìN</strong>
    <div class="check-group">
        <label class="check-item"><input type="checkbox" id="m1"> Dificultades en rendimiento acad√©mico</label>
        <label class="check-item"><input type="checkbox" id="m2"> Problemas de atenci√≥n/concentraci√≥n</label>
        <label class="check-item"><input type="checkbox" id="m3"> Dificultades emocionales</label>
        <label class="check-item"><input type="checkbox" id="m4"> Problemas de conducta escolar</label>
        <label class="check-item"><input type="checkbox" id="m5"> Orientaci√≥n vocacional</label>
        <label class="check-item"><input type="checkbox" id="m6"> Evaluaci√≥n preventiva/tamizaje</label>
        <label class="check-item"><input type="checkbox" id="m7"> Solicitud propia/padres</label>
        <div class="check-item" style="align-items: flex-end;">
            <input type="checkbox" id="m8"> <span>Otro:</span> <input type="text" id="motivoOtro" style="width:300px;">
        </div>
    </div>

    <p><strong>B. OBJETIVOS:</strong> Identificar factores, evaluar fortalezas, dise√±ar plan de apoyo y promover bienestar integral.</p>

    <strong>C. PROCEDIMIENTOS A REALIZAR</strong>
    <p>1. EVALUACI√ìN:</p>
    <div class="row">
        <div class="col">
            <label class="check-item"><input type="checkbox" id="p1"> Entrevista Estudiante</label>
            <label class="check-item"><input type="checkbox" id="p2"> Entrevista Padres</label>
            <label class="check-item"><input type="checkbox" id="p3"> Pruebas Psicol√≥gicas</label>
            <label class="check-item"><input type="checkbox" id="p4"> Hab. Estudio</label>
        </div>
        <div class="col">
            <label class="check-item"><input type="checkbox" id="p5"> Eval. Emocional</label>
            <label class="check-item"><input type="checkbox" id="p6"> Aptitudes/Intereses</label>
            <label class="check-item"><input type="checkbox" id="p7"> Observaci√≥n Aula</label>
        </div>
    </div>
    
    <p style="margin-top:10px;">2. INTERVENCI√ìN:</p>
    <div class="row">
        <div class="col">
            <label class="check-item"><input type="checkbox" id="i1"> Apoyo Individual</label>
            <label class="check-item"><input type="checkbox" id="i2"> Talleres</label>
            <label class="check-item"><input type="checkbox" id="i3"> T√©cnicas Estudio</label>
        </div>
        <div class="col">
            <label class="check-item"><input type="checkbox" id="i4"> Manejo Emociones</label>
            <label class="check-item"><input type="checkbox" id="i5"> O. Vocacional</label>
            <label class="check-item"><input type="checkbox" id="i6"> Trabajo Docentes</label>
        </div>
    </div>

    <!-- IV. CONFIDENCIALIDAD -->
    <div class="section-title">IV. CONFIDENCIALIDAD Y L√çMITES</div>
    <p>La informaci√≥n es <strong>CONFIDENCIAL</strong>, excepto en casos de: Riesgo para s√≠ mismo, Riesgo para otros, Sospecha de abuso/maltrato u Orden judicial.</p>
    <p><strong>Autorizo compartir informaci√≥n relevante (solo lo necesario) con:</strong></p>
    <div class="row">
        <div class="col"><label class="check-item"><input type="checkbox" id="c1"> Docentes</label></div>
        <div class="col"><label class="check-item"><input type="checkbox" id="c2"> Tutor Grupal</label></div>
        <div class="col"><label class="check-item"><input type="checkbox" id="c3"> Direcci√≥n/Coord.</label></div>
    </div>

    <!-- DECLARACI√ìN -->
    <div class="section-title">XII. DECLARACI√ìN Y FIRMAS</div>
    <p>He le√≠do y comprendido la informaci√≥n. He tenido oportunidad de hacer preguntas. Comprendo que la participaci√≥n es voluntaria.</p>
    
    <div style="background:#e3f2fd; padding:15px; border:1px solid #1565C0; margin:20px 0;">
        <label class="check-item" style="font-weight:bold; font-size:12pt;">
            <input type="radio" name="consent" value="SI" checked> S√ç DOY MI CONSENTIMIENTO para la evaluaci√≥n e intervenci√≥n.
        </label>
        <label class="check-item" style="font-weight:bold; font-size:12pt;">
            <input type="radio" name="consent" value="NO"> NO DOY MI CONSENTIMIENTO.
        </label>
    </div>

    <div class="row" style="margin-top:50px; gap:50px;">
        <div class="col" style="text-align:center;">
            <div style="border-bottom:1px solid #000; margin-bottom:5px; height:30px;"></div>
            <label>Firma del Estudiante</label>
        </div>
        <div class="col" style="text-align:center;">
            <div style="border-bottom:1px solid #000; margin-bottom:5px; height:30px;"></div>
            <label>Firma Padre/Tutor</label>
        </div>
    </div>
    <div class="row" style="margin-top:40px;">
        <div class="col" style="text-align:center;">
            <div style="border-bottom:1px solid #000; margin-bottom:5px; height:30px;"></div>
            <label>Firma Profesional Responsable</label>
        </div>
    </div>

</div>

<!-- BOTONES FLOTANTES -->
<div class="fab-container">
    <button class="btn-fab btn-print" onclick="generarPDFOficial()">
        üìÑ Generar PDF
    </button>
    <button class="btn-fab btn-save" onclick="location.href='index.html'">
        üè† Volver al Men√∫
    </button>
</div>

<script>
    document.getElementById('fecha').valueAsDate = new Date();
    document.getElementById('folio').value = "2024-" + Math.floor(Math.random() * 1000);

    function generarPDFOficial() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF('p', 'mm', 'legal'); // Tama√±o Oficio/Legal para que quepa m√°s
        
        const getValue = (id) => document.getElementById(id).value || "________________";
        const isChecked = (id) => document.getElementById(id).checked ? "X" : " ";

        // Configuraci√≥n Fuente
        doc.setFont("times", "normal");
        doc.setFontSize(11);

        // --- P√ÅGINA 1 ---
        
        // Encabezado
        doc.setFont("times", "bold");
        doc.setFontSize(14);
        doc.text("CENTRO DE BACHILLERATO TECNOL√ìGICO AGROPECUARIO No. 130", 105, 20, null, null, "center");
        doc.setFontSize(12);
        doc.text("CONSENTIMIENTO INFORMADO PARA SERVICIOS PSICOPEDAG√ìGICOS", 105, 30, null, null, "center");
        
        doc.setFontSize(10);
        doc.text(`Folio: ${getValue('folio')}`, 150, 40);
        doc.text(`Fecha: ${getValue('fecha')}`, 150, 45);

        let y = 55;
        
        // Funci√≥n para dibujar t√≠tulos de secci√≥n
        const drawSection = (title) => {
            doc.setFillColor(220, 220, 220);
            doc.rect(20, y, 175, 7, 'F');
            doc.setFont("times", "bold");
            doc.text(title, 22, y+5);
            y += 12;
            doc.setFont("times", "normal");
        };

        // DATOS
        drawSection("DATOS DE IDENTIFICACI√ìN");
        doc.text(`Estudiante: ${getValue('nombreEstudiante')}`, 25, y);
        doc.text(`Edad: ${getValue('edad')}`, 130, y);
        doc.text(`Grupo: ${getValue('grupo')}`, 160, y);
        y += 6;
        doc.text(`Especialidad: ${getValue('especialidad')}`, 25, y);
        doc.text(`Semestre: ${getValue('semestre')}`, 130, y);
        y += 6;
        doc.text(`Tutor: ${getValue('tutor')}`, 25, y);
        doc.text(`Tel: ${getValue('telefono')}`, 130, y);
        y += 6;
        doc.text(`Responsable: ${getValue('profesional')}`, 25, y);
        doc.text(`C√©dula: ${getValue('cedula')}`, 130, y);
        y += 10;

        // INFORMACI√ìN
        drawSection("I. INFORMACI√ìN SOBRE EL SERVICIO");
        doc.text("El estudiante ha sido identificado para recibir evaluaci√≥n e intervenci√≥n psicopedag√≥gica.", 25, y); y += 6;
        
        doc.setFont("times", "bold"); doc.text("A. Motivo de Atenci√≥n:", 25, y); y += 6;
        doc.setFont("times", "normal");
        
        const checksMotivos = [
            {id:'m1', t:'Rendimiento Acad√©mico'}, {id:'m2', t:'Atenci√≥n/Concentraci√≥n'},
            {id:'m3', t:'Dificultades Emocionales'}, {id:'m4', t:'Conducta'},
            {id:'m5', t:'Vocacional'}, {id:'m6', t:'Tamizaje/Preventivo'},
            {id:'m7', t:'Solicitud Propia/Padres'}, {id:'m8', t:'Otro: ' + getValue('motivoOtro')}
        ];
        
        checksMotivos.forEach(m => {
            doc.text(`[ ${isChecked(m.id)} ] ${m.t}`, 30, y);
            y += 5;
        });
        y += 5;

        doc.setFont("times", "bold"); doc.text("C. Procedimientos:", 25, y); y += 6;
        doc.setFont("times", "normal");
        doc.text("Evaluaci√≥n:", 30, y); y += 5;
        doc.text(`[ ${isChecked('p1')} ] Entrevista Alumno   [ ${isChecked('p2')} ] Entrevista Padres   [ ${isChecked('p3')} ] Pruebas Psico.`, 35, y); y += 5;
        doc.text(`[ ${isChecked('p4')} ] Hab. Estudio        [ ${isChecked('p5')} ] Eval. Emocional     [ ${isChecked('p7')} ] Observaci√≥n`, 35, y); y += 8;
        
        doc.text("Intervenci√≥n:", 30, y); y += 5;
        doc.text(`[ ${isChecked('i1')} ] Apoyo Individual    [ ${isChecked('i2')} ] Talleres            [ ${isChecked('i3')} ] T√©cnicas Estudio`, 35, y); y += 5;
        doc.text(`[ ${isChecked('i4')} ] Manejo Emociones    [ ${isChecked('i5')} ] Vocacional          [ ${isChecked('i6')} ] Trabajo Docentes`, 35, y); y += 10;

        // DERECHOS Y RESPONSABILIDADES (Texto resumido para caber)
        drawSection("II. DERECHOS Y III. RESPONSABILIDADES");
        doc.setFontSize(10);
        const textosLegales = [
            "Derechos: Recibir informaci√≥n clara, trato digno, confidencialidad y conocer resultados.",
            "Responsabilidades Estudiante: Asistir puntualmente, participar activamente y comunicar dificultades.",
            "Responsabilidades Padres: Apoyar asistencia y acudir a reuniones cuando se solicite."
        ];
        textosLegales.forEach(t => { doc.text("‚Ä¢ " + t, 25, y); y += 5; });
        y += 5;

        // CONFIDENCIALIDAD
        doc.setFontSize(11);
        drawSection("IV. CONFIDENCIALIDAD");
        doc.text("La informaci√≥n es confidencial, excepto en casos de riesgo de vida, abuso u orden judicial.", 25, y); y += 6;
        doc.text("Autorizo compartir informaci√≥n necesaria con:", 25, y); y += 6;
        doc.text(`[ ${isChecked('c1')} ] Docentes    [ ${isChecked('c2')} ] Tutor Grupal    [ ${isChecked('c3')} ] Direcci√≥n Escolar`, 35, y); y += 12;

        // DECLARACI√ìN
        drawSection("XII. DECLARACI√ìN DE CONSENTIMIENTO");
        
        const acepto = document.querySelector('input[name="consent"]:checked').value === "SI";
        
        if(acepto) {
            doc.setFont("times", "bold");
            doc.text("[ X ] S√ç DOY MI CONSENTIMIENTO para la evaluaci√≥n e intervenci√≥n.", 35, y);
            doc.text("[   ] NO DOY MI CONSENTIMIENTO.", 35, y+6);
        } else {
            doc.text("[   ] S√ç DOY MI CONSENTIMIENTO.", 35, y);
            doc.setFont("times", "bold");
            doc.text("[ X ] NO DOY MI CONSENTIMIENTO.", 35, y+6);
        }
        doc.setFont("times", "normal");
        y += 20;

        // FIRMAS
        doc.line(40, y, 90, y); doc.line(120, y, 170, y);
        y += 5;
        doc.text("Firma del Estudiante", 45, y); doc.text("Firma Padre/Tutor", 125, y);
        
        y += 25;
        doc.line(80, y, 130, y);
        y += 5;
        doc.text("Firma Profesional Responsable", 82, y);

        doc.save(`Consentimiento_${getValue('nombreEstudiante')}.pdf`);
    }
</script>
</body>
</html>

