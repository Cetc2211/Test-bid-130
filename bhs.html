<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Evaluaci√≥n BHS - CBTa 130</title>
<style>
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; margin: 0; background-color: #f0f2f5; color: #1c1c1e; }
    header { background: linear-gradient(135deg, #212121 0%, #424242 100%); color: white; text-align: center; padding: 25px; font-weight: bold; font-size: 1.4rem; }
    .container { max-width: 800px; margin: 20px auto; padding: 20px; background: white; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
    h2 { color: #212121; text-align: center; border-bottom: 2px solid #bdbdbd; padding-bottom: 10px; }
    .input-group { margin-bottom: 15px; }
    label { font-weight: 600; display: block; margin-bottom: 8px; }
    input { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 8px; box-sizing: border-box; }
    .question-item { border-bottom: 1px solid #eee; padding: 15px 0; display: grid; grid-template-columns: 1fr 100px; gap: 15px; align-items: center; }
    .q-text { font-weight: 500; color: #333; font-size: 0.95rem; }
    .q-opts { display: flex; justify-content: space-between; }
    .opt-label { cursor: pointer; display: flex; flex-direction: column; align-items: center; font-weight: bold; }
    .opt-v { color: #2E7d32; } .opt-f { color: #c62828; }
    input[type="radio"] { width: 24px; height: 24px; border: 2px solid #ccc; border-radius: 50%; margin-top: 5px; cursor: pointer; }
    input[type="radio"]:checked { border-color: currentColor; background-color: currentColor; box-shadow: inset 0 0 0 4px white; }
    .buttons { display: flex; flex-direction: column; gap: 15px; margin-top: 30px; }
    button { padding: 16px; border: none; border-radius: 12px; font-size: 1.1em; font-weight: 700; color: white; cursor: pointer; width: 100%; }
    .whatsapp { background-color: #25D366; }
    .local-save { background-color: #1565C0; }
    .reset { background-color: #757575; }
    .btn-back { background-color: #78909c; }
    #result-area { display: none; text-align: center; margin-top: 20px; padding: 20px; background: #f5f5f5; border-radius: 10px; }
</style>
</head>
<body>
<header>CBTa No.130<br><span style="font-size:0.8em;">Escala de Desesperanza (BHS)</span></header>
<div class="container">
    <div id="test-form">
        <h2>Datos del Alumno</h2>
        <div class="input-group"><label>Nombre:</label><input type="text" id="nombre" required></div>
        <div class="input-group"><label>Fecha:</label><input type="date" id="fecha" required></div>
        <div style="background-color:#eee; padding:15px; border-radius:8px; margin:20px 0; font-size:0.9em; border-left:5px solid #212121;">
            <strong>Instrucciones:</strong> Marque si es <strong>VERDADERA (V)</strong> o <strong>FALSA (F)</strong>.
        </div>
        <div id="questions-list"></div>
        <div class="buttons">
            <button type="button" class="whatsapp" onclick="finalizarTest()">‚úÖ Finalizar</button>
            <button type="button" class="btn-back" onclick="window.location.href='index.html'">‚Ü©Ô∏è Cancelar y Volver</button>
        </div>
    </div>
    <div id="result-area">
        <h3 style="color:#212121;">Resultados Listos</h3>
        <div class="buttons">
            <button type="button" class="local-save" onclick="guardarLocalmente()">üíæ Guardar en Expediente</button>
            <button type="button" class="whatsapp" onclick="enviarWhatsApp()">üì≤ Enviar WhatsApp</button>
            <button type="button" class="reset" onclick="location.reload()">üîÑ Nuevo</button>
            <button type="button" class="btn-back" onclick="window.location.href='index.html'">üè† Ir al Men√∫</button>
        </div>
    </div>
</div>
<script>
    const NUMERO_DESTINO = "523111477413"; const STORAGE_KEY = "cbta_paciente_temp";
    const items = ["1. Veo futuro esperanza", "2. Abandonar todo", "3. Cosas mal mejorar√°n", "4. No imagino vida 10 a√±os", "5. Tiempo suficiente", "6. Espero √©xito", "7. Futuro oscuro", "8. Espero cosas buenas", "9. No tengo suerte", "10. Experiencias prepararon", "11. Veo desagradable", "12. No espero conseguir", "13. Espero ser feliz", "14. Cosas no marchar√°n", "15. Fe futuro", "16. Absurdo querer", "17. Improbable satisfacci√≥n", "18. Futuro vago", "19. √âpocas buenas", "20. In√∫til tratar"];
    const container = document.getElementById('questions-list');
    items.forEach((txt, i) => { let idx = i + 1; container.innerHTML += `<div class="question-item"><div class="q-text">${idx}. ${txt}</div><div class="q-opts"><label class="opt-label opt-v"><span>V</span><input type="radio" name="bhs${idx}" value="V"></label><label class="opt-label opt-f"><span>F</span><input type="radio" name="bhs${idx}" value="F"></label></div></div>`; });
    document.getElementById('fecha').valueAsDate = new Date();
    let datosFinales = null;
    function finalizarTest() {
        const nombre = document.getElementById('nombre').value; const fecha = document.getElementById('fecha').value;
        if(!nombre) { alert("Nombre requerido"); return; }
        let total = 0, count = 0; const keyTrue = [2, 4, 7, 9, 11, 12, 14, 16, 17, 18, 20];
        for(let i=1; i<=20; i++){ const el = document.querySelector(`input[name="bhs${i}"]:checked`); if(el) { let v = el.value; if(keyTrue.includes(i)) { if(v==="V") total++; } else { if(v==="F") total++; } count++; } }
        if(count < 20) { alert("Faltan preguntas"); return; }
        datosFinales = { nombre, fecha, total };
        document.getElementById('test-form').style.display = 'none'; document.getElementById('result-area').style.display = 'block'; window.scrollTo(0,0);
    }
    function guardarLocalmente() { if(!datosFinales) return; let cur = JSON.parse(localStorage.getItem(STORAGE_KEY)) || {}; let up = { ...cur, nombre: datosFinales.nombre, bhs: datosFinales.total }; localStorage.setItem(STORAGE_KEY, JSON.stringify(up)); alert("‚úÖ BHS guardado."); }
    function enviarWhatsApp(){ if(!datosFinales) return; let m = `‚ö´ *BHS*%0Aüë§ ${datosFinales.nombre}%0Aüìä Score: ${datosFinales.total}`; window.open(`https://wa.me/${NUMERO_DESTINO}?text=${m}`, '_blank'); }
</script>
</body>
</html>


