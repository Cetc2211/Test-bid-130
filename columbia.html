<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Evaluaci√≥n Columbia - CBTa 130</title>
<style>
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; margin: 0; background-color: #ffebee; color: #1c1c1e; }
    /* Encabezado ROJO ALERTA */
    header { background: linear-gradient(135deg, #c62828 0%, #d32f2f 100%); color: white; text-align: center; padding: 25px; font-weight: bold; font-size: 1.4rem; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
    .container { max-width: 800px; margin: 20px auto; padding: 20px; background: white; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
    h2 { color: #c62828; text-align: center; margin-top: 0; border-bottom: 2px solid #ffcdd2; padding-bottom: 10px; }
    
    .input-group { margin-bottom: 15px; }
    label { font-weight: 600; display: block; margin-bottom: 8px; color: #333; }
    input { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 8px; font-size: 16px; box-sizing: border-box; }
    
    .question-block { background: #fff; padding: 20px; border-radius: 10px; margin-bottom: 20px; border-left: 5px solid #e57373; }
    .q-text { font-weight: bold; font-size: 1.1em; margin-bottom: 15px; color: #b71c1c; }
    
    .yes-no-group { display: flex; gap: 20px; }
    .yn-label { display: flex; align-items: center; padding: 15px 25px; border: 2px solid #eee; border-radius: 8px; cursor: pointer; font-weight: bold; flex: 1; justify-content: center; transition: all 0.2s; }
    .yn-label:hover { background: #fafafa; }
    
    /* Estilos al seleccionar */
    input[type="radio"] { display: none; }
    input[type="radio"]:checked + span { }
    
    /* Colores condicionales visuales */
    .yn-label.si input:checked + span { color: #c62828; }
    .yn-label.si:has(input:checked) { border-color: #c62828; background: #ffebee; }
    
    .yn-label.no input:checked + span { color: #2e7d32; }
    .yn-label.no:has(input:checked) { border-color: #2e7d32; background: #e8f5e9; }

    .buttons { display: flex; flex-direction: column; gap: 15px; margin-top: 30px; }
    button { padding: 16px; border: none; border-radius: 12px; font-size: 1.1em; font-weight: 700; color: white; cursor: pointer; width: 100%; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
    .whatsapp { background-color: #25D366; }
    .reset { background-color: #757575; }
    
    #hidden-section { display: none; }
</style>
</head>
<body>
<header>CBTa No.130<br><span style="font-size:0.8em; font-weight:normal">Escala Columbia (C-SSRS)</span></header>

<div class="container">
    <div id="test-form">
        <h2>Datos del Alumno</h2>
        <div class="input-group"><label>Nombre Completo:</label><input type="text" id="nombre" required></div>
        <div class="input-group"><label>Fecha:</label><input type="date" id="fecha" required></div>
        
        <div style="background-color:#ffebee; padding:15px; border-radius:8px; margin:20px 0; font-size:0.9em; border-left:5px solid #c62828;">
            <strong>Instrucciones:</strong> Responda con honestidad sobre el <strong>√öLTIMO MES</strong>.
        </div>

        <!-- P1 -->
        <div class="question-block">
            <div class="q-text">1. ¬øHa deseado estar muerto o poder dormirse y no despertar?</div>
            <div class="yes-no-group">
                <label class="yn-label si"><input type="radio" name="q1" value="SI"><span>S√ç</span></label>
                <label class="yn-label no"><input type="radio" name="q1" value="NO"><span>NO</span></label>
            </div>
        </div>

        <!-- P2 -->
        <div class="question-block">
            <div class="q-text">2. ¬øHa tenido pensamientos sobre suicidarse?</div>
            <div class="yes-no-group">
                <label class="yn-label si"><input type="radio" name="q2" value="SI" onchange="checkQ2()"><span>S√ç</span></label>
                <label class="yn-label no"><input type="radio" name="q2" value="NO" onchange="checkQ2()"><span>NO</span></label>
            </div>
        </div>

        <!-- SECCI√ìN CONDICIONAL (3, 4, 5) -->
        <div id="hidden-section">
            <div class="question-block">
                <div class="q-text">3. ¬øHa pensado en c√≥mo podr√≠a hacerlo? (M√©todo)</div>
                <div class="yes-no-group">
                    <label class="yn-label si"><input type="radio" name="q3" value="SI"><span>S√ç</span></label>
                    <label class="yn-label no"><input type="radio" name="q3" value="NO"><span>NO</span></label>
                </div>
            </div>
            <div class="question-block">
                <div class="q-text">4. ¬øHa tenido intenciones de actuar seg√∫n estos pensamientos?</div>
                <div class="yes-no-group">
                    <label class="yn-label si"><input type="radio" name="q4" value="SI"><span>S√ç</span></label>
                    <label class="yn-label no"><input type="radio" name="q4" value="NO"><span>NO</span></label>
                </div>
            </div>
            <div class="question-block">
                <div class="q-text">5. ¬øHa empezado a elaborar detalles o tiene un plan espec√≠fico?</div>
                <div class="yes-no-group">
                    <label class="yn-label si"><input type="radio" name="q5" value="SI"><span>S√ç</span></label>
                    <label class="yn-label no"><input type="radio" name="q5" value="NO"><span>NO</span></label>
                </div>
            </div>
        </div>

        <!-- P6 (Siempre visible) -->
        <div class="question-block" style="border-left-color: #000;">
            <div class="q-text">6. CONDUCTA: ¬øAlguna vez en su vida ha hecho algo para terminar con su vida?</div>
            <small style="display:block; margin-bottom:10px; color:#555;">(Ej: Juntar pastillas, cortarse, escribir notas, intentos previos)</small>
            <div class="yes-no-group">
                <label class="yn-label si"><input type="radio" name="q6" value="SI" onchange="checkQ6()"><span>S√ç</span></label>
                <label class="yn-label no"><input type="radio" name="q6" value="NO" onchange="checkQ6()"><span>NO</span></label>
            </div>
        </div>

        <!-- P6b Reciente -->
        <div class="question-block" id="q6b-block" style="display:none; background:#fff3e0;">
            <div class="q-text">¬øEsto sucedi√≥ en los √∫ltimos 3 meses?</div>
            <div class="yes-no-group">
                <label class="yn-label si"><input type="radio" name="q6b" value="SI"><span>S√ç</span></label>
                <label class="yn-label no"><input type="radio" name="q6b" value="NO"><span>NO</span></label>
            </div>
        </div>

        <div class="buttons">
            <button type="button" class="whatsapp" onclick="finalizarTest()">üö® Finalizar</button>
        </div>
    </div>
</div>

<script>
    const NUMERO_DESTINO = "523111477413"; 
    
    function checkQ2() {
        const val = document.querySelector('input[name="q2"]:checked').value;
        const sec = document.getElementById('hidden-section');
        if (val === "SI") sec.style.display = "block";
        else {
            sec.style.display = "none";
            // Limpiar selecci√≥n interna
            sec.querySelectorAll('input').forEach(i => i.checked = false);
        }
    }

    function checkQ6() {
        const val = document.querySelector('input[name="q6"]:checked').value;
        const sec = document.getElementById('q6b-block');
        if (val === "SI") sec.style.display = "block";
        else {
            sec.style.display = "none";
            sec.querySelectorAll('input').forEach(i => i.checked = false);
        }
    }

    document.getElementById('fecha').valueAsDate = new Date();

    function finalizarTest() {
        const nombre = document.getElementById('nombre').value;
        const fecha = document.getElementById('fecha').value;
        if(!nombre) { alert("Nombre requerido"); return; }

        // Recolectar respuestas
        const getVal = (name) => {
            const el = document.querySelector(`input[name="${name}"]:checked`);
            return el ? el.value : "-";
        };

        const q1 = getVal("q1");
        const q2 = getVal("q2");
        const q3 = getVal("q3");
        const q4 = getVal("q4");
        const q5 = getVal("q5");
        const q6 = getVal("q6");
        const q6b = getVal("q6b"); // Reciente

        // Validaciones m√≠nimas
        if (q1==="-" || q2==="-" || q6==="-") { alert("Conteste las preguntas visibles"); return; }
        if (q2==="SI" && (q3==="-" || q4==="-" || q5==="-")) { alert("Conteste las preguntas de detalle"); return; }

        // Mensaje
        let m = `üö® *DATOS COLUMBIA*%0Aüë§ ${nombre}%0AüìÖ ${fecha}%0A%0A1. Deseo muerte: ${q1}%0A2. Pensamientos: ${q2}`;
        
        if(q2==="SI") {
            m += `%0A3. M√©todo: ${q3}%0A4. Intenci√≥n: ${q4}%0A5. Plan: ${q5}`;
        }
        
        m += `%0A6. Conducta Vida: ${q6}`;
        if(q6==="SI") m += `%0A   (Reciente <3m): ${q6b}`;

        window.location.href = `https://wa.me/${NUMERO_DESTINO}?text=${m}`;
    }
</script>
</body>
</html>

